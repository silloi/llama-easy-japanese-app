"""
やさしい日本語翻訳ツール - 設定ファイル
文化庁「在留支援のためのやさしい日本語ガイドライン」に準拠
"""


# Groq API設定
MODEL_NAME = "llama-3.3-70b-versatile"
TEMPERATURE = 0.3  # 安定性重視
MAX_TOKENS = 1500  # より長い変換に対応

# システムプロンプト（文化庁ガイドライン3ステップに基づく）
SYSTEM_PROMPT = """あなたは「やさしい日本語」の専門家です。
文化庁の「在留支援のためのやさしい日本語ガイドライン」に完全準拠して、
通常の日本語を、外国人（CEFR A2-B1レベルを想定）にもわかりやすい「やさしい日本語」に翻訳してください。

【重要な変換ステップ】

■ステップ1: 日本人にわかりやすい文章にする
1. 情報を整理し、必要な情報だけに絞る（不要な情報は削除）
2. 一文を短く分ける（目安：20〜30文字）
3. 一文に一つの情報だけを入れる（一文一義）
4. 箇条書きや改行を活用して、視覚的に読みやすくする
5. 複雑な文構造（重文・複文）を避け、単文にする

■ステップ2: 外国人にもわかりやすい文章にする

【語彙の簡素化】
- 漢語→和語に変換する
  NG例: 実施する、開始する、終了する、確認する
  OK例: する、始める、終わる、見る
- 難しい言葉→簡単な言葉に置き換える
  NG例: 速やかに、適宜、概ね、若干
  OK例: すぐに、必要なとき、だいたい、少し
- 難しい言葉を使う場合は、説明を添える
  例: 在留カード（外国人が持つカード）

【文型の簡素化】
- 受動態→能動態に変換する
  NG例: 〜される、〜られる
  OK例: 〜する、〜します
- 二重否定は絶対に使わない
  NG例: 〜ないことはない、〜なくはない
  OK例: 〜できます、〜あります
- 曖昧な表現を避け、具体的に書く
  NG例: なるべく、できるだけ、〜等
  OK例: 具体的な例を挙げる

【敬語の簡素化】
- 「です・ます」調で統一する
- 謙譲語・尊敬語は使わない
  NG例: いたします、申し上げます、お持ちになる、ご覧になる
  OK例: します、言います、持つ、見る
- 過度な丁寧表現を避ける
  NG例: ございます、いただく、賜る
  OK例: あります、もらう

【その他の重要ルール】
- カタカナ語は必要最小限にする（使う場合は説明を添える）
- 時制を明確にする（いつのことか必ず示す）
- 文化的背景を前提としない（日本固有の習慣は説明する）
- 数字は具体的に示す（「多くの」→「たくさんの」or 具体的な数）
- 指示代名詞（これ、それ、あれ）は具体的な名詞に置き換える

【振り仮名のルール】
- JLPT N3-N2レベル以上の難しい漢字には、振り仮名をつける
- 振り仮名の形式: 漢字(ひらがな)
  例: 在留(ざいりゅう)、手続(てつづ)き、市役所(しやくしょ)
- 簡単な漢字（日常的な漢字）には振り仮名は不要
  不要な例: 人、日、行く、見る、書く、持つ
- 専門用語や行政用語には必ず振り仮名をつける
  例: 転入届(てんにゅうとどけ)、婚姻届(こんいんとどけ)、接種券(せっしゅけん)
- 振り仮名は読みやすさのバランスを考えて、つけすぎない

■ステップ3: 確認
- 原文の意味が正確に伝わるか確認
- 誤解を招く表現がないか確認
- すべてのルールが適用されているか確認

【絶対に守るべきルール】
1. 一文は20〜30文字程度（最大でも40文字以内）
2. 一文に一つの情報のみ
3. 複数の手順や情報は必ず箇条書きにする
4. 難しい漢語は和語に置き換える
5. 受動態は能動態に変換する
6. 敬語は「です・ます」のみ使用
7. 二重否定は絶対に使わない
8. 時制を明確にする
9. 難しい漢字には振り仮名をつける（形式: 漢字(ひらがな)）

【出力形式】
- 変換後の「やさしい日本語」のみを出力してください
- 説明や前置きは一切不要です
- 原文の意味を正確に保ちながら、上記すべてのルールに従って変換してください
- 複数の情報がある場合は、必ず箇条書き（・）を使用してください
- 難しい漢字には必ず振り仮名をつけてください（形式: 漢字(ひらがな)）
"""

# 主要ルール（詳細版）
GUIDELINE_RULES = """
【やさしい日本語の詳細ルール】

■文の構造
1. 一文一義: 一つの文には一つの情報だけを書く
2. 文の長さ: 一文は20〜30文字程度（最大40文字）
3. 単文化: 重文・複文を避け、単文にする
4. 箇条書き: 複数の情報は必ず箇条書きにする

■語彙の選択
5. 和語優先: 漢語より和語を使う
   × 実施する、開始する、終了する → ○ する、始める、終わる
6. 簡単な言葉: 難しい言葉を避ける
   × 速やかに、適宜、概ね → ○ すぐに、必要なとき、だいたい
7. 説明を添える: 難しい言葉には説明を添える
   例: 在留カード（外国人が持つカード）
8. カタカナ語制限: 必要最小限にし、説明を添える

■文型の選択
9. 能動態優先: 受動態を避け、能動態を使う
   × 〜される → ○ 〜します
10. 二重否定禁止: 絶対に使わない
    × 〜ないことはない → ○ 〜あります
11. 具体的表現: 曖昧な表現を避ける
    × なるべく、できるだけ → ○ 具体的に指定

■敬語の使用
12. です・ます調: 「です・ます」で統一
13. 謙譲語・尊敬語禁止:
    × いたします、お持ちになる → ○ します、持ちます
14. 過度な丁寧語禁止:
    × ございます → ○ あります

■その他
15. 時制の明確化: いつのことか明確にする
16. 文化的中立性: 日本固有の習慣は説明する
17. 具体的な数字: 「多くの」→「たくさんの」or 具体的数
18. 指示代名詞の回避: 「これ」→具体的な名詞

■振り仮名
19. 難しい漢字に振り仮名: JLPT N3-N2レベル以上の漢字に振り仮名をつける
    形式: 漢字(ひらがな)
    例: 在留(ざいりゅう)、手続(てつづ)き、市役所(しやくしょ)
20. 簡単な漢字は不要: 日常的な漢字には振り仮名は不要
    例: 人、日、行く、見る、書く、持つ（振り仮名なし）
21. 専門用語には必須: 行政用語や専門用語には必ず振り仮名
    例: 転入届(てんにゅうとどけ)、婚姻届(こんいんとどけ)
"""

# Few-shot Examples（改善版・振り仮名付き）
FEW_SHOT_EXAMPLES = [
    {
        "original": "婚姻をするときは、役所に届出をし、届出が受理されると、婚姻が成立します。",
        "yasashii": "結婚(けっこん)するときは、次のことをします。\n\n・役所(やくしょ)に「婚姻届(こんいんとどけ)」という紙を出します\n・役所(やくしょ)が「婚姻届(こんいんとどけ)」を受け取ります\n・結婚(けっこん)が成立(せいりつ)します"
    },
    {
        "original": "新規の上陸許可を受けて日本に入国した場合、在留カードが交付された方は、住所を定めた日から14日以内に、在留カードをお持ちになってお住まいの市町村において転入の届出をする必要があります。",
        "yasashii": "日本に入った人で、在留(ざいりゅう)カード（外国人が持つカード）をもらった人は、次のことをしてください。\n\n・住む場所を決めます\n・決めた日から14日以内(いない)に手続(てつづ)きをします\n・在留(ざいりゅう)カードを持って、市役所(しやくしょ)か区役所(くやくしょ)に行きます\n・「転入届(てんにゅうとどけ)」という紙を出します"
    },
    {
        "original": "大きな地震が発生するなどした場合、安否の確認、見舞い、問合せなどで電話がつながりにくい状況が起こることがあります。",
        "yasashii": "大きな地震(じしん)が起きたとき、電話がつながりにくくなることがあります。\nたくさんの人が電話を使うからです。"
    },
    {
        "original": "発熱や咳などの症状がある場合は、事前に医療機関に電話で相談してから受診してください。マスクを着用し、公共交通機関の利用は控えてください。",
        "yasashii": "熱や咳(せき)が出たときは、次のことをしてください。\n\n・まず、病院(びょういん)に電話します\n・病院(びょういん)の人に相談(そうだん)します\n・それから、病院(びょういん)に行きます\n・マスクをつけます\n・バスや電車は使わないでください"
    },
    {
        "original": "会社を退職する際は、少なくとも2週間前までに退職の意思を伝える必要があります。就業規則に別の定めがある場合は、それに従ってください。",
        "yasashii": "会社を辞めるときは、次のことをします。\n\n・2週間(しゅうかん)前までに、会社に「辞めます」と言います\n・会社のルールで違(ちが)う決まりがあるときは、そのルールに従(したが)います"
    },
    {
        "original": "賃貸契約を解約する場合は、契約書に記載された予告期間（通常1〜2ヶ月前）までに、大家さんまたは不動産会社に書面で通知する必要があります。",
        "yasashii": "借(か)りている家を出るときは、次のことをします。\n\n・契約書(けいやくしょ)（家を借(か)りたときの紙）を見ます\n・いつまでに伝(つた)えるか、確認(かくにん)します（多くの場合(ばあい)、1か月前か2か月前です）\n・大家(おおや)さん（家の持ち主）か不動産(ふどうさん)会社に、紙に書いて伝(つた)えます"
    },
    {
        "original": "本施策の実施に当たっては、関係各所との調整を速やかに行い、適宜必要な措置を講じることとする。",
        "yasashii": "この計画(けいかく)を始めるときは、次のことをします。\n\n・関係(かんけい)する人たちと、すぐに相談(そうだん)します\n・必要(ひつよう)なときに、必要(ひつよう)なことをします"
    },
    {
        "original": "ご不明な点がございましたら、遠慮なくお問い合わせください。",
        "yasashii": "わからないことがあったら、質問(しつもん)してください。"
    },
    {
        "original": "当該書類の提出期限は厳守していただきますようお願い申し上げます。",
        "yasashii": "書類(しょるい)は、期限(きげん)までに必(かなら)ず出してください。"
    },
    {
        "original": "災害時においては、近隣住民との相互扶助が重要となりますので、日頃からコミュニケーションを図るよう心がけてください。",
        "yasashii": "災害(さいがい)（地震(じしん)や台風(たいふう)など）が起きたときは、近くに住んでいる人と助け合うことが大切(たいせつ)です。\nいつも、近くの人と話すようにしてください。"
    },
    {
        "original": "申請が承認されない場合もございますので、予めご了承ください。",
        "yasashii": "申請(しんせい)（お願(ねが)いすること）が認(みと)められないこともあります。\nこのことを知っておいてください。"
    },
    {
        "original": "各種証明書の発行には、手数料が必要となります。詳細につきましては、窓口でお尋ねください。",
        "yasashii": "証明書(しょうめいしょ)（あなたのことを証明(しょうめい)する紙）を作るときは、お金がかかります。\n\nいくらかかるかは、窓口(まどぐち)で聞いてください。"
    },
    {
        "original": "台風の接近に伴い、公共交通機関が運休する可能性がありますので、最新の情報をご確認ください。",
        "yasashii": "台風(たいふう)が来るとき、バスや電車が止まることがあります。\n\n新しい情報(じょうほう)を、必(かなら)ず確認(かくにん)してください。"
    },
    {
        "original": "本サービスの利用に際しては、利用規約を遵守していただく必要がございます。",
        "yasashii": "このサービスを使うときは、ルールを守ってください。"
    },
    {
        "original": "ワクチン接種を希望される方は、事前に予約が必要です。接種当日は、接種券と本人確認書類をお持ちください。",
        "yasashii": "ワクチンを打ちたい人は、次のことをしてください。\n\n・先に予約(よやく)します\n・ワクチンを打つ日に、次のものを持っていきます\n  - 接種券(せっしゅけん)（ワクチンを打つための券(けん)）\n  - 本人確認書類(ほんにんかくにんしょるい)（パスポートや在留(ざいりゅう)カードなど）"
    }
]

# サンプルテキスト（UI用）
SAMPLE_TEXTS = {
    "行政": "新規の上陸許可を受けて日本に入国した場合、在留カードが交付された方は、住所を定めた日から14日以内に、在留カードをお持ちになってお住まいの市町村において転入の届出をする必要があります。",

    "医療": "発熱や咳などの症状がある場合は、事前に医療機関に電話で相談してから受診してください。マスクを着用し、公共交通機関の利用は控えてください。",

    "防災": "大きな地震が発生するなどした場合、安否の確認、見舞い、問合せなどで電話がつながりにくい状況が起こることがあります。",

    "雇用": "会社を退職する際は、少なくとも2週間前までに退職の意思を伝える必要があります。就業規則に別の定めがある場合は、それに従ってください。",

    "住宅": "賃貸契約を解約する場合は、契約書に記載された予告期間（通常1〜2ヶ月前）までに、大家さんまたは不動産会社に書面で通知する必要があります。"
}
